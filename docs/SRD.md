# 软件需求文档 (SRD)
# 天文行星位置查询展示网站

**版本：** 1.0
**日期：** 2026-02-21
**状态：** 已批准

---

## 1. 项目概述

### 1.1 目的

本项目旨在构建一个基于浏览器的天文行星位置查询与可视化网站，让用户能够直观地了解太阳系行星的实时或历史位置，支持两种观测视角和两种工作模式。

### 1.2 范围

- 支持太阳系八大行星（水星、金星、地球/月球、火星、木星、土星、天王星、海王星）及太阳的位置计算与可视化
- 支持背景恒星（约9000颗肉眼可见星）的显示
- 全客户端计算，无需后端服务器
- 支持桌面端和移动端浏览器

### 1.3 用户群体

- 天文爱好者
- 学生和教育工作者
- 对天象感兴趣的普通用户

---

## 2. 功能需求

### FR-1 工作模式

| 编号 | 需求描述 | 优先级 |
|------|---------|--------|
| FR-1.1 | **本地模式**：自动获取浏览器地理位置（Geolocation API）+ 当前系统时间，每分钟自动刷新天象数据 | 高 |
| FR-1.2 | **指定模式**：用户手动输入经纬度或城市名 + 日期时间，查询任意历史或未来天象 | 高 |
| FR-1.3 | 模式切换时保留当前视角设置 | 中 |
| FR-1.4 | 本地模式下若用户拒绝定位权限，提示手动输入位置 | 高 |

### FR-2 太阳系3D视角

| 编号 | 需求描述 | 优先级 |
|------|---------|--------|
| FR-2.1 | 俯瞰太阳系黄道面，显示太阳 + 八大行星的轨道路径和当前位置 | 高 |
| FR-2.2 | 支持鼠标拖拽旋转、滚轮缩放、右键平移（桌面端） | 高 |
| FR-2.3 | 行星按相对大小（对数缩放）显示，带颜色区分 | 高 |
| FR-2.4 | 显示行星轨道椭圆路径（半透明线条） | 高 |
| FR-2.5 | 检测并高亮显示特殊天象：行星连珠（≥3颗行星黄经差<30°）、冲（行星与太阳黄经差≈180°）、合（≈0°） | 中 |
| FR-2.6 | 点击行星弹出信息卡片，显示：距太阳距离（AU）、距地球距离（AU）、当前星座、赤经赤纬 | 高 |
| FR-2.7 | 显示行星名称标签（可切换显示/隐藏） | 中 |
| FR-2.8 | 时间轴控件：可快进/快退，观察行星运动轨迹 | 中 |

### FR-3 地球天空视角

| 编号 | 需求描述 | 优先级 |
|------|---------|--------|
| FR-3.1 | 以观测者为中心的半球天穹，显示地平线（区分地面/天空） | 高 |
| FR-3.2 | 显示所有行星在天空中的位置（高度角 > -18° 的行星均显示，地平线以下半透明） | 高 |
| FR-3.3 | 显示背景恒星（视星等 < 6.5，约9000颗），按星等设置亮度和大小 | 高 |
| FR-3.4 | 显示黄道线（行星运行轨迹带）和天赤道线 | 中 |
| FR-3.5 | 显示88个星座的连线和中英文名称 | 中 |
| FR-3.6 | 支持拖拽旋转视角（桌面：鼠标拖拽；移动端：单指滑动） | 高 |
| FR-3.7 | 显示方位角标注（东南西北） | 中 |
| FR-3.8 | 点击行星/恒星显示详细信息 | 中 |

### FR-4 数据与精度

| 编号 | 需求描述 | 优先级 |
|------|---------|--------|
| FR-4.1 | 行星位置精度：优于1角分（使用 astronomy-engine 库） | 高 |
| FR-4.2 | 支持时间范围：公元前3000年至公元3000年 | 中 |
| FR-4.3 | 全部客户端计算，无需外部API，支持离线使用 | 高 |
| FR-4.4 | 考虑大气折射修正（地平线附近天体） | 低 |

### FR-5 UI控制

| 编号 | 需求描述 | 优先级 |
|------|---------|--------|
| FR-5.1 | 顶部/侧边栏：模式切换按钮（本地模式 / 指定模式） | 高 |
| FR-5.2 | 时间控制：日期时间选择器 + 快进/快退按钮（步长：1小时/1天/1月） | 高 |
| FR-5.3 | 视角切换：太阳系视角 ↔ 天空视角（Tab切换或按钮） | 高 |
| FR-5.4 | 行星信息面板：点击天体后展开，显示详细天文数据 | 高 |
| FR-5.5 | 深色太空主题UI（黑色背景，蓝/金色调） | 高 |
| FR-5.6 | 当前位置显示（城市名或经纬度） | 中 |
| FR-5.7 | 特殊天象提示横幅（检测到连珠/冲/合时显示） | 中 |

### FR-6 移动端支持

| 编号 | 需求描述 | 优先级 |
|------|---------|--------|
| FR-6.1 | 响应式布局：自适应手机（<768px）、平板（768-1024px）、桌面（>1024px） | 高 |
| FR-6.2 | 触摸手势：单指拖拽旋转、双指捏合缩放（替代鼠标操作） | 高 |
| FR-6.3 | 移动端控制面板：底部抽屉式面板（替代侧边栏） | 高 |
| FR-6.4 | 行星信息卡片：移动端全屏弹出 | 中 |
| FR-6.5 | 本地模式优先：移动端默认请求GPS定位 | 高 |
| FR-6.6 | 移动端性能优化：减少星点数量（mag < 5.0，约1600颗） | 中 |

---

## 3. 非功能需求

### NFR-1 性能
- 初始加载时间 < 5秒（含星表数据）
- 3D渲染帧率 ≥ 30fps（桌面端中等配置）
- 移动端帧率 ≥ 24fps

### NFR-2 兼容性
- 支持浏览器：Chrome 90+、Firefox 88+、Safari 14+、Edge 90+
- 需要 WebGL 支持
- 移动端：iOS Safari 14+、Android Chrome 90+

### NFR-3 可用性
- 界面语言：中文（主）
- 无障碍：关键操作支持键盘导航

### NFR-4 安全性
- 不收集或存储用户位置数据
- 位置信息仅在本地使用，不发送至任何服务器

---

## 4. 约束条件

- 纯前端实现，无后端服务
- 不依赖付费API
- 行星位置数据来源：astronomy-engine 本地计算（基于 VSOP87 算法）
- 星表数据：HYG Database（开源，CC BY-SA 2.5）

---

## 5. 验收标准

1. 本地模式能自动获取位置并显示当前行星位置，与 Stellarium 对比误差 < 1°
2. 指定模式能正确显示历史天象（如2020年12月21日木土大合）
3. 太阳系视图能清晰展示行星轨道和相对位置
4. 天空视图能正确显示行星高度角和方位角
5. 移动端触摸操作流畅，无明显卡顿
